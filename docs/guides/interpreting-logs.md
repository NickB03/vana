# Interpreting VANA Logs Guide

[Home](../../index.md) > [Guides](../index.md) > Interpreting Logs

This guide provides an overview of how to find, read, and interpret logs generated by the VANA system. Effective log analysis is crucial for troubleshooting issues, understanding system behavior, and monitoring performance.

## 1. Overview of Logging in VANA

VANA components are expected to use a structured logging approach, facilitated by utilities in `tools/logging/`. This means logs should ideally be:

*   **Structured:** Often in JSON format or a consistent key-value pair format, making them easier to parse and query.
*   **Timestamped:** All log entries should have accurate timestamps.
*   **Contextual:** Include relevant information like the component name, function/method, and potentially a request ID or session ID to trace operations across different parts of the system.
*   **Leveled:** Use standard log levels (e.g., DEBUG, INFO, WARNING, ERROR, CRITICAL) to indicate the severity and nature of the log entry.

## 2. Log Locations

Log files for VANA components might be found in several places, depending on the component and configuration:

*   **Default Log Directory:** VANA might have a central `logs/` directory in the project root. Check `config/environment.py` or specific component configurations for default log paths.
    *   Example: `vana/logs/flask_api.log`, `vana/logs/streamlit_ui.log`, `vana/logs/vector_search_monitor.log`.
*   **Component-Specific Logs:** Some tools or scripts might generate their own log files in their respective directories or a subdirectory within `logs/`.
*   **Standard Output/Error:** When running scripts or applications directly in the terminal (like `dashboard/flask_app.py` or `streamlit run dashboard/app.py`), logs are often printed directly to `stdout` (standard output) and `stderr` (standard error).
*   **Scheduled Task Logs:** For scheduled tasks (e.g., via `cron`), output is typically redirected to a specified file. For example, as shown in the [Scheduled Tasks Guide](scheduled-tasks.md):
    ```
    ... >> /full/path/to/vana/logs/scheduled_monitor.log 2>&1
    ```
*   **Cloud Logging (if applicable):** If VANA components are deployed on cloud platforms (e.g., GCP Cloud Run, Cloud Functions), logs would typically be available through the cloud provider's logging service (e.g., Google Cloud Logging).

## 3. Log Levels and Their Meanings

Understanding log levels is key to filtering and prioritizing information:

*   **`DEBUG`:** Detailed information, typically of interest only when diagnosing problems. Includes fine-grained operational data, variable values, etc. Usually disabled in production.
*   **`INFO`:** Confirmation that things are working as expected. General operational entries, system startup/shutdown messages, major actions completed.
*   **`WARNING`:** An indication that something unexpected happened, or an indication of some problem in the near future (e.g., ‘disk space low’). The software is still working as expected, but the issue should be monitored.
*   **`ERROR`:** Due to a more serious problem, the software has not been able to perform some function. Often indicates a failure in a specific operation or request.
*   **`CRITICAL`:** A serious error, indicating that the program itself may be unable to continue running. This usually requires immediate attention.

The active log level (i.e., the minimum severity that gets logged) is often configurable, potentially via an environment variable like `LOG_LEVEL` in the `.env` file or a setting in `config/environment.py`.

## 4. Common Log Entry Structure (Example)

While the exact format can vary, a structured log entry (e.g., in JSON) might look like this:

```json
{
  "timestamp": "2025-05-17T11:30:00.123Z",
  "level": "INFO",
  "component": "VectorSearchClient",
  "function": "find_neighbors",
  "message": "Successfully performed vector search.",
  "query_text_sample": "latest AI trends",
  "num_results": 5,
  "duration_ms": 150,
  "request_id": "xyz789" 
}
```

Or, in a more traditional text format:

```
2025-05-17 11:30:00,123 INFO [VectorSearchClient:find_neighbors] Successfully performed vector search. (query_sample="latest AI trends", results=5, duration_ms=150, request_id="xyz789")
```

**Key fields to look for:**
*   `timestamp`: When the event occurred.
*   `level`: Severity (DEBUG, INFO, WARNING, ERROR, CRITICAL).
*   `component` or `logger_name`: The part of VANA that generated the log (e.g., `FlaskAPI`, `StreamlitUI`, `DocumentProcessor`, `ScheduledVectorSearchMonitor`).
*   `function` or `method`: The specific function or method within the component.
*   `message`: The main log message describing the event.
*   **Contextual Data:** Additional key-value pairs providing context (e.g., `query_text_sample`, `file_path`, `user_id`, `error_details`, `duration_ms`, `request_id`).

## 5. How to Read and Analyze Logs

### 5.1. Using Command-Line Tools (for text logs)
*   **`tail`:** Useful for monitoring logs in real-time.
    ```bash
    tail -f logs/flask_api.log  # Shows new log entries as they are written
    tail -n 100 logs/flask_api.log # Shows the last 100 lines
    ```
*   **`grep`:** For searching logs for specific keywords, error messages, or timestamps.
    ```bash
    grep "ERROR" logs/scheduled_monitor.log # Find all error messages
    grep "request_id_xyz789" logs/*.log # Search for a specific request ID across multiple logs
    grep "2025-05-17 10:" logs/flask_api.log # Find logs from a specific hour
    ```
*   **`less` or `more`:** For paginating through large log files.
    ```bash
    less logs/large_log_file.log
    ```
    (Inside `less`, you can search using `/your_search_term`.)

### 5.2. For JSON Logs
*   **`jq`:** A powerful command-line JSON processor. Very useful for filtering, formatting, and querying JSON logs.
    ```bash
    # Pretty-print JSON logs
    tail -f logs/app_json.log | jq .

    # Filter for ERROR level messages and select specific fields
    cat logs/app_json.log | jq 'select(.level == "ERROR") | {timestamp, component, message, error_details}'
    ```
*   **Text Editors/IDEs:** Many modern text editors and IDEs have good support for viewing and searching JSON files.

### 5.3. General Log Analysis Tips
*   **Start with Timestamps:** Narrow down the time window of interest if you know when an issue occurred.
*   **Look for ERROR and CRITICAL Messages:** These usually pinpoint where things went wrong.
*   **Trace Request IDs:** If available, use unique request IDs or session IDs to follow the lifecycle of an operation across different components or log entries.
*   **Correlate Logs from Different Components:** If an issue involves multiple VANA services (e.g., Streamlit UI calls Flask API, which then uses `VectorSearchClient`), check logs from all relevant components around the time of the issue.
*   **Understand Normal Behavior:** Familiarize yourself with what normal INFO logs look like. This helps you spot unusual patterns or messages more easily.
*   **Context is Key:** Don't just look at an error message in isolation. Examine the log entries immediately before and after it to understand the sequence of events.
*   **Check Configuration:** Log messages related to configuration loading (often at startup) can reveal issues with `.env` settings.

## 6. Specific Component Logging Characteristics (Examples)

*   **Flask API (`dashboard/flask_app.py`):**
    *   Logs incoming HTTP requests (method, path, status code).
    *   Authentication successes/failures.
    *   Errors during request processing.
    *   Calls to backend services like `VectorSearchHealthChecker`.
*   **Streamlit UI (`dashboard/app.py`):**
    *   May log user interactions (if implemented).
    *   Errors related to UI rendering.
    *   API calls made to the Flask backend and their success/failure.
*   **Core Tools (`tools/` directory):**
    *   `VectorSearchClient`: Logs interactions with Vertex AI, query successes/failures, latencies.
    *   `DocumentProcessor`: Logs file processing stages, text extraction results, OCR attempts, chunking details.
    *   `KnowledgeGraphManager`: Logs MCP server interactions, entity/relation operations.
*   **Scheduled Scripts (`scripts/`):**
    *   `ScheduledVectorSearchMonitor`: Logs start/end of check cycles, overall health status found, details of individual checks, and any alerts triggered.

## 7. Adjusting Log Verbosity

*   The level of detail in logs is often controlled by a `LOG_LEVEL` setting in `config/environment.py` or directly in the `.env` file.
*   For troubleshooting, you might temporarily increase the log level to `DEBUG` to get more detailed information. Remember to set it back to `INFO` or `WARNING` in a production-like environment to avoid excessive log volume and performance overhead.

Effective log interpretation is a vital skill for maintaining and troubleshooting VANA. By understanding where to find logs, their structure, and how to analyze them, you can gain valuable insights into the system's behavior.
