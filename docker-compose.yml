version: '3.8'

services:
  vana-orchestrator:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8081:8080"
    environment:
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
    volumes:
      - .:/app

  vana-api-adapter:
    build:
      context: ./vana-api-adapter
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - VANA_ORCHESTRATOR_URL=http://vana-orchestrator:8080/run_sse
    depends_on:
      - vana-orchestrator

  open-webui:
    build:
      context: ./open-webui
      dockerfile: Dockerfile
    ports:
      - "3000:8080"
    environment:
      - OPENAI_API_BASE_URL=http://vana-api-adapter:8080/v1
      - OPENAI_API_KEY=dummy-key
    depends_on:
      - vana-api-adapter
